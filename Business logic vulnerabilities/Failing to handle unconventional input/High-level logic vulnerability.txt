This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".

You can log in to your own account using the following credentials: wiener:peter

1. Wchodzimy w zadanie na stronie, uruchamiamy burpa, klikamy my account, logujemy sie danymi wiener/peter. Musimy kupić kurtkę skórzaną, ale mamy tylko 100 kredytów na koncie
2. Wchodzimy teraz w byle jaki produkt może to być mood enhancer, który kosztuje 38.78$, i dodajemy produkt do koszyka, teraz w burpie wchodzimy w http history i szukamy POST URL:/cart, wysyłamy to połączenie do repetera
3. W repeterze zmieniamy ilość z 1 na np -10, klikamy send, w przeglądarce w koszyku odświeżamy i widzimy, że w koszyku mam -9 produktów
4. klikamy home, wejdź w skórzaną kurtkę i dodaj ją do koszyka i wróc do koszyka, aktualna cena to 987.98 $ ( skórzana kurtka kosztuje 1337.00$)
5. Aby zakupić kurtkę musimy zwiększyć negatywną liczbę produktu mood enhancer do momentu, w którym będzię nas na nią stać, więc w repeterze ponownie klikamy send i w koszyku zrobiło nam się -19 mood enhancer a cena wynosi teraz 600$, w repeterze powtarzamy proces i mamy -29 mood enhancer, a cena to 212$, w repeterze zmieniamy z -10 na -5, klikamy send, odświeżamy stronę i mamy -34 mood enchancery, a cena to 18$
6. Klikamy place order by zakupić naszę rzeczy i zakończyć zadanie


ENG:

1.With Burp running, log in and add a cheap item to your cart.
2.In Burp, go to "Proxy" > "HTTP history" and study the corresponding HTTP messages. Notice that the quantity is determined by a parameter in the POST /cart request.
3.Go to the "Intercept" tab and turn on interception. Add another item to your cart and go to the intercepted POST /cart request in Burp.
4.Change the quantity parameter to an arbitrary integer, then forward any remaining requests. Observe that the quantity in the cart was successfully updated based on your input.
5.Repeat this process, but request a negative quantity this time. Check that this is successfully deducted from the cart quantity.
6.Request a suitable negative quantity to remove more units from the cart than it currently contains. Confirm that you have successfully forced the cart to contain a negative quantity of the product. Go to your cart and notice that the total price is now also a negative amount.
7.Add the leather jacket to your cart as normal. Add a suitable negative quantity of the another item to reduce the total price to less than your remaining store credit.
8.Place the order to solve the lab.