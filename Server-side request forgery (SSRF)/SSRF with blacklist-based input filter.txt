This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.

The developer has deployed two weak anti-SSRF defenses that you will need to bypass.

1. Wchodzimy do zadania i uruchamiamy burpa, wybieramy jakąś kategorie, włączamy intercepta, klikamy check stock, przechwycone połączenie przesyłamy do repetera i wyłączamy intercepta.
2. Kiedy w repeterze po dekodowaniu stockapi próbujemy wpisać localhosta dostajemy 400 bad request ze względu na zabezpieczenia strony, w takim wypadku trzeba to obejść.
3. Wpisujemy zatem w stock api http://127.1/ i klikamy send, otrzymujemy 200 ok. W response kiedy wejdziemy w render ukazuje się nam strona z admin panelem
4. Aby dostać uprawnienia w response wpisujemy słowo admin i szukamy scieżki, mamy /admin. Wpisujemy zatem do linijki api http://127.1/admin i klikamy ok. Otrzymujemy error ze względu na zabezpieczenia, najprawdopodobniej słowo admin znajduje się w blacklist i nie możemy go użyć
5. Aby złamać zabezpieczenia, możemy np zrobić encode pierwszej literze w adminie czyli a. Bedzię to wyglądać tak %61dmin. Klikamy send i nadal otrzymujemy błąd, możemy zrobić podwójny encode, będzie to wyglądać tak %25%36%31dmin klikamy send i otrzymujemy 200 ok 
6. W response jak klikniemy render widzimy dostęp do admin panela oraz użytkowników w tym carlosa, teraz w response wpisujemy carlos i szukamy stringa. W zadaniu wygląda to tak /admin/delete?username=carlos
7. Na koniec łączymy wszystko i aby usunąć konto carlosa, nasza linijka powinna wyglądać tak http://127.1/%25%36%31dmin/delete?username=carlos, klikamy send i otrzymujemy 302 found. W teori zadanie jest zakończone, ale aby się upewnić wpisujemy  http://127.1/%25%36%31dmin klikamy send, następnie render i patrzymy czy konto carlosa zostało usunięte. W zadaniu nie ma już konta carlosa.


ENG:
1.Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
2.Change the URL in the stockApi parameter to http://127.0.0.1/ and observe that the request is blocked.
3.Bypass the block by changing the URL to: http://127.1/
4.Change the URL to http://127.1/admin and observe that the URL is blocked again.
5.Obfuscate the "a" by double-URL encoding it to %2561 to access the admin interface and delete the target user.

