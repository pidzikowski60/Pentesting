This lab contains a reflected XSS vulnerability in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.

To solve the lab, perform a cross-site scripting attack that bypasses the WAF and calls the print() function.



1. Urucuhamiamy zadanie ze strony oraz uruchamiamy burpa, na stronie w search bar wpisujemy <img src=1 onerror=print()> otrzymujemy komunikat, że ,,tag is not allowed"
2. W burpie przechodzimy do http history i szukamy GET URL:/?serarch z responsem tag is not allowed 
3. Wysyłamy tego requesta do intrudera i usuwamu linijkę z search oraz wpisujmy <§§>
4. Otwieramy cheat sheet XSS i klikamy copy tags to clipboard wchodzimy do payloads i wklejamy payloads options i zaczynay atak
5. Po wykonaniu się ataku widzimy, że dwa requesty mają 200 ok body i custom items, przechodzimy do  pozycji i tam wpisujemy <body20%§§=1> , następnie przechodzimy do cheet sheet, kopiujemy eventy i wklejamy je w payloads option i zaczynamy atak ponownie
6. w 200 ok widzimy onresize, więc przechodzimy do exploit servera i tam wpisujemy <iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'> i podmieniamy adres na ten z naszego zadania


ENG:
1Inject a standard XSS vector, such as:
<img src=1 onerror=print()>
2.Observe that this gets blocked. In the next few steps, we'll use use Burp Intruder to test which tags and attributes are being blocked.
3.Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.
4.In Burp Intruder, in the Positions tab, click "Clear §". Replace the value of the search term with: <>
5.Place the cursor between the angle brackets and click "Add §" twice, to create a payload position. The value of the search term should now look like: <§§>
6.Visit the XSS cheat sheet and click "Copy tags to clipboard".
7.In Burp Intruder, in the Payloads tab, click "Paste" to paste the list of tags into the payloads list. Click "Start attack".
8.When the attack is finished, review the results. Note that all payloads caused an HTTP 400 response, except for the body payload, which caused a 200 response.
9.Go back to the Positions tab in Burp Intruder and replace your search term with:
<body%20=1>
10.Place the cursor before the = character and click "Add §" twice, to create a payload position. The value of the search term should now look like: <body%20§§=1>
11.Visit the XSS cheat sheet and click "copy events to clipboard".
12.In Burp Intruder, in the Payloads tab, click "Clear" to remove the previous payloads. Then click "Paste" to paste the list of attributes into the payloads list. Click "Start attack".
13.When the attack is finished, review the results. Note that all payloads caused an HTTP 400 response, except for the onresize payload, which caused a 200 response.
14.Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID:
<iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>
15.Click "Store" and "Deliver exploit to victim".