This lab's email change functionality is vulnerable to CSRF. It attempts to block CSRF attacks, but only applies defenses to certain types of requests.

To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer's email address.

You can log in to your own account using the following credentials: wiener:peter

1.Wchodzimy na stonę z zadaniem i uruchamiamy burpa, logujemy się danymi podanymi w zadaniu, włączamy intercepta i zmieniamy email, przechwycone połączenie wysyłamy do repetera i wyłączamy intercepta
2. Zmieniamy request metody z post na get. Klikamy ppm w repeterze i klikamy change request method, klikamy send i otrzymujemy 302 found widzimy, że nasz email się zmienił 
3. możemy także wrócić, usunąc token crsf zmienić email w repetwerze, kliknąć send, następnie follow redeirection i w response wyszukać naszegp emaila po zmianie, jeśli jest to znaczy, że mamy wrażliwość 
4. Następnie kopiujemy linijkę:
<form action="https://0aca00b6036454ae80c6125900f20006.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="testotest@op.px">
</form>
<script>
        document.forms[0].submit();
</script>
podmieniamy dane, wrzucamy w exploit server i wysyłamy ofierze, (dane podmieniamy z już zmienionego post na get requesta)


ENG:

1.Open Burp's browser and log in to your account. Submit the "Update email" form, and find the resulting request in your Proxy history.
2.Send the request to Burp Repeater and observe that if you change the value of the csrf parameter then the request is rejected.
3.Use "Change request method" on the context menu to convert it into a GET request and observe that the CSRF token is no longer verified.
4.If you're using Burp Suite Professional, right-click on the request, and from the context menu select Engagement tools / Generate CSRF PoC. Enable the option to include an auto-submit script and click "Regenerate".

Alternatively, if you're using Burp Suite Community Edition, use the following HTML template. You can get the request URL by right-clicking and selecting "Copy URL".
<form action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="anything%40web-security-academy.net">
</form>
<script>
        document.forms[0].submit();
</script>
5.Go to the exploit server, paste your exploit HTML into the "Body" section, and click "Store".
6.To verify if the exploit will work, try it on yourself by clicking "View exploit" and checking the resulting HTTP request and response.
7.Change the email address in your exploit so that it doesn't match your own.
8.Store the exploit, then click "Deliver to victim" to solve the lab.