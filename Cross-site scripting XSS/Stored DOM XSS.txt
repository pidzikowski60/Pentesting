This lab demonstrates a stored DOM vulnerability in the blog comment functionality. To solve this lab, exploit this vulnerability to call the alert() function.


1. Uruchamiamy zadanie i w search bar wpisujemy tą linijkę: <><img src=1 onerror=alert(1)>
Aby zapobiec XSS, strona wykorzystuje funkcję JavaScript replace() do encoda nawiasów kątowych. Jednak, gdy pierwszymi literami jest ciąg znaków, funkcja zastępuje tylko pierwsze znaki. Wykorzystujemy tę lukę, umieszczając po prostu dodatkowy zestaw nawiasów kątowych na początku komentarza. Te nawiasy kątowe zostaną encodowane, ale wszystkie kolejne nawiasy kątowe nie zostaną naruszone, co pozwoli nam skutecznie obejść filtr i wstrzyknąć HTML.


ENG:

Post a comment containing the following vector:
<><img src=1 onerror=alert(1)>
In an attempt to prevent XSS, the website uses the JavaScript replace() function to encode angle brackets. However, when the first argument is a string, the function only replaces the first occurrence. We exploit this vulnerability by simply including an extra set of angle brackets at the beginning of the comment. These angle brackets will be encoded, but any subsequent angle brackets will be unaffected, enabling us to effectively bypass the filter and inject HTML.