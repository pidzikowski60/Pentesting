This lab's password change functionality makes it vulnerable to brute-force attacks. To solve the lab, use the list of candidate passwords to brute-force Carlos's account and access his "My account" page.

Your credentials: wiener:peter
Victim's username: carlos
Candidate passwords


1. Wchodzimy na strone, uruchamiamy Burpa, wchodzimy w my account, wpisujemy wiener oraz peter, logujemy się i zmieniamy hasło na np peter1, włączamy intercepta w burpie i wtedy na stronie klikamy change password.
2. W przechwyconym responsie widzimy, poprawne dane, klikamy forward, teraz robimy to samo, tylko w zmianie hasła, wpisujemy fałszywe obecne hasło zamiast peter1 to np peter100, kiedy użyjemy forwarda w burpie to strona nas wyloguje i będziemy musieli poczekać minutę na ponowne zalogwanie się
3. Logujemy się ponownie na strone z prawidłowym loginem, robimy to samo, tylko, że wpisujemy inne hasło w potwierdzeniu nowego hasła, obecne hasło peter 100, nowe hasło peter50, potwierdz nowe hasło nowym hasłem peter0, otrzymujemy, current password is incorrect zamiast wylogowania
4. Tak więc, robimy to samo, tylko, w current password wpisujemy nasze aktualne czyli peter1, w nowym haśle wpisujemy peter100 a w potwierdzeniu peter50, kliknij forward i zobacz co dostajemy, robimy to wszysztko po to aby zobaczyć, który parametr jest wrażliwy.
5. Wchodzimy w http history szukamy POST URL:/my-account/change-password z danymi peter1,peter100,peter50
6. Wysyłamy połączenie do intrudera, czyścimy wszystko, zmieniamy username z wiener na carlos, zaznaczamy peter1 i dodajemy, wybieramy atak snajpera, wybieramy simple list, wchodzimy w candidate password i kopiujemy wszystkie hasła, następnie wklejamy je w simple list, wchodzimy w opcje na dole w grep-match czyścimy wszystko i dodajemy New passwords do not match i zacznij atak
7. W ataku filtruj po new passwords do not match, hasłow zadaniu to access, zaloguj się na stronie jako carlos z hasłem access




ENG:

1.With Burp running, log in and experiment with the password change functionality. Observe that the username is submitted as hidden input in the request.
2.Notice the behavior when you enter the wrong current password. If the two entries for the new password match, the account is locked. However, if you enter two different new passwords, an error message simply states Current password is incorrect. If you enter a valid current password, but two different new passwords, the message says New passwords do not match. We can use this message to enumerate correct passwords.
3.Enter your correct current password and two new passwords that do not match. Send this POST /my-account/change-password request to Burp Intruder.
4.In Burp Intruder, change the username parameter to carlos and add a payload position to the current-password parameter. Make sure that the new password parameters are set to two different values. For example:
username=carlos&current-password=§incorrect-password§&new-password-1=123&new-password-2=abc
5.On the Payloads tab, enter the list of passwords as the payload set
6.On the Settings tab, add a grep match rule to flag responses containing New passwords do not match. Start the attack.
7.When the attack finished, notice that one response was found that contains the New passwords do not match message. Make a note of this password.
8.In the browser, log out of your own account and lock back in with the username carlos and the password that you just identified.
9.Click My account to solve the lab.