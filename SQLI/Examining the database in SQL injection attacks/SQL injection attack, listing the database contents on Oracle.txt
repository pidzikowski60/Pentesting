This lab contains a SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response so you can use a UNION attack to retrieve data from other tables.

The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.

To solve the lab, log in as the administrator user.


1. Uruchorm burp suite comunity eddition, włącz intercept on i kliknij w category na stronie zadania, przechwycony wynik prześlij do reapetera i wyłącz intercepta
2. Ustal liczbę kolumn oraz kolumny które zawierają tekst, w reapeterze po category umieszczamy ' UNION select NULL From DUAL--(musimy wpisać from dual bo inaczej nie przejdzie na oracle oraz zrobić encoded(ctrl+u)) dodajemy nulle do momentu nie wystąpienia błędu oraz podmieniamy nulle za tekst i patrzymy czy nie wyrzuci nam błędu. Oczywiście wszystko w encoded (ctrl+u)
3. Wiemy, że baza jest w Oracle także, teraz musimy uzyskać stoły, także korzystamy z cheat sheet i wpisujemy w burpie: ' UNION select table_name,NULL FROM all_tables--(ctrl+u) . W responsie szukamy czegoś co ma user. W zadaniu znajdujemy USERS_JYPOMG
4. Teraz musimy ustalić nazwy kolumn. Zaglądamy do cheat sheet i wpisujemy: ' UNION select  table_name,NULL FROM all_tab_columns WHERE table_name = 'USERS_JYPOMG'--(ctrl+u). W responsie szukamy kolumn o nazwie username i password. W zadaniu jest to USERNAME_LDANZP i hasło PASSWORD_DYZWEQ
5. Na koniec musimy uzyskać login i hasło. Wpisujemy: ' UNION select USERNAME_LDANZP,PASSWORD_DYZWEQ FROM USERS_JYPOMG--(ctrl+u). klikamy sens i w response szukamy loginu i hasła administratora. W zadaniu jest to administrator, DS!#fdKh%#52GDvnGnV!



ENG:

1. Run burp suite community edition, turn intercept on and click on category on task page, send captured result to repeater and turn off intercept
2. Set the number of columns and the columns that contain the text, in the repeater after category we put ' UNION select NULL From DUAL--(we must enter from dual or it will not work on oracle, do encoded(ctrl+u)) add null until it does not occur error and replace nulls with the text and see if it will throw us an error. All encoded of course (ctrl+u)
3. We know that the database is in Oracle as well, now we need to get the tables, so we use the cheat sheet and type in the burp: ' UNION select table_name,NULL FROM all_tables--(ctrl+u) . In the response we are looking for something that has name user. In the task we find USERS_JYPOMG
4. Now we need to set the column names. We look in the cheat sheet and enter: ' UNION select table_name,NULL FROM all_tab_columns WHERE table_name = 'USERS_JYPOMG'--(ctrl+u). In response we are looking for columns named username and password. In the task, it is USERNAME_LDANZP and the password is PASSWORD_DYZWEQ
5. Finally, we need to obtain a login and password. Type: ' UNION select USERNAME_LDANZP,PASSWORD_DYZWEQ FROM USERS_JYPOMG--(ctrl+u). click sense and in response we are looking for administrator login and password. In the task, it is the administrator, DS!#fdKh%#52GDvnGnV!