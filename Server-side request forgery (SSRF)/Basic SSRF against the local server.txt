This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.

1. Wchodzimy na strone z zadaniem i uruchamiamy burpa, wchodzimy w kategorie, włączamy interceptra w burpie i na danym produkcie klikamy check stock, przechwycone połączenie wysyłamy do repetera i wyłączamy intercepta
2. Dekodujemy url z stockapi poprzez ctrl+u+shift i próbujemy bez encoda wejść, nie możemy więc zamiast url wpisujemy http://localhost i próbujemy, w odpowiedzi dostajemy 200 ok, więc dzięki temu wiemy, że strona jest podatna na ssrf, w renderze możemy zobaczyć, że załadowała nam się strona podana w stockapi i w renderze widzimy co nam wyskoczyło, a wyskoczyła nam strona z admin panelem
3. W response, w sekcji raw szukamy słowa admin, widzimy to słowo także, modyfikujemy naszą wcześniejszą linijkę na http://localhost/admin klikamy send w raw mamy 200 ok i w renderze widzimy, że przeszliśmy do admin panela, w którym są użytkowicy, w tym carlos, teraz szukamy w response słowa carlos i widzimy linijkę "/admin/delete?username=carlos".
4. Modyfikujemy linijkę na http://localhost/admin/delete?username=carlos klikamy send i otrzymujemy 302 found. W teorii usuneliśmy konto carlosa, ale aby być na 100 pewnym trzeba zrobić dodatkową rzecz.
5. Aby się upewnić modyfikujemy linijkę na http://localhost/admin klikamy send i w response klikamy w render i patrzymy czy konto carlosa zostało usunięte. W zadaniu go nie ma.


ENG:
1.Browse to /admin and observe that you can't directly access the admin page.
2.Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
3.Change the URL in the stockApi parameter to http://localhost/admin. This should display the administration interface.
4.Read the HTML to identify the URL to delete the target user, which is:
http://localhost/admin/delete?username=carlos
5.Submit this URL in the stockApi parameter, to deliver the SSRF attack.