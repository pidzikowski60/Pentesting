This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.

The results of the SQL query are not returned, and no error messages are displayed. But the application includes a "Welcome back" message in the page if the query returns any rows.

The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.

To solve the lab, log in as the administrator user.


1.Wchodzimy w ćwiczenie, uruchamiamy program burp, wchodzimy w kategorie na stronie i patrzymy czy mamy powiadomienie"welcome back".
2.Włączmy w burpie intercept on i klikamy przycisk home, przechwytujemy połączenie w burpie i wysyłamy go do reapetera, po czym wyłączamy intercepta
3.W repeterze klikamy wyślij i patrzymy w response czy mamy wiadomość welcome back by zobaczyć czy trackingId działa poprawnie. W zadaniu TrackingId=RvLfBu6s9EZR1VYNd
4.Następnie w repeterze po TrackingId=RvLfBu6s9EZR1VYNd wpisujemy TrackingId=RvLfBu6s9EZR1VYNd' and 1=1--(ctrl+u) jeżeli dostaniemy welcome back to znaczy, że ten case jest true. Jeżeli byśmy wpisali 1=0 to dostlibyśmy false.
5.Teraz będziemy zadawać bazie pytanie True or False na podstawie 1=1, więc wpisujemy po tracking id, ' and( select 'x' from users LIMIT 1)='x'--(ctrl+u)  jeżeli x=x to dostaniemy welcome back i dowiemy się czy istnieje user table. Dostaliśmy welcome back, to znaczy, że user table istnieje.
6.Teraz sprawdzimy czy administrator istnieje w users table. Wpisujemy po trackingId: ' and (select username from users where username='administrator')='administrator'--(ctrl+u) klikamy send i jeżeli dostaniemy w response wiadomość welcome back to adminsitrator istnieje, W zadaniu dostaliśmy taką wiadomość.
7.Teraz należy odgadnąć hasło administratora. Wpierw musimy ustalić długośc hasła, a więc wpisujemy: ' and (select users where username ='administrator' and LENGTH(password)>1)='administrator'--(ctrl+u). Otrzymujemy welcome back, więc hasło ma więcej niż jeden znak.
8.Aby nie robić tego cały czas ręcznie, użyjemy burp Intrudera, więc wysyłamy z repetera do intrudera,' and (select users where username ='administrator' and LENGTH(password)>1)='administrator'-- w pozycjach clearujemy wszystko, zaznaczamy liczbę 1 z tej linijki i  klikamy add. Wybieramy atak snajpera, przechodzimy do payload wybieramy Numbers i w opcjach wpisujemy from 1 to 50 step 1 i zaczynamy atak. przy 20 requeście atak zmienia długość, więc wiemy, że hasło ma 20 znaków
9.Ustalamy hasło, wracamy do repetera i wpisujemy ' and (select substring(password,1,1) from users where username'administrator')='a'--(ctrl+u) pierwsza litera hasła to nie a, nie będziemy tego robić ręcznie, więc wysyłamy to do intrudera. W pozycjach wszystko czyścimy, zaznaczamy a i dodajemy, wybieramy atak snajpera i w payload wybieramy brute forcer wybieramy min length 1 i max length 1, zaczynamy atak. szukamy znaku z inną długością. W zadaniu pierwsza litera to 5
10. Zamiast robić tego 20 razy, można użyć innego rodzaju ataku, czyścimy wszystko, podświetlamy pierwszą jedynkę z naszej linijki i a, klikamy dodaj i zmieniamy snajpera na cluster bomba w payload, set 1 ustawiamy na numbers from 1 to 20 step 1. Payload set 2 ustawiamy brute forcer min length 1 i max length 1 zaczynamy atak. W community eddition na zakończenie ataku musimy czekać około 2 i pół godziny. Po zakończonym ataku z lewej strony mamy numery a po prawej stronie litery po filtrowaniu.
11. Aby uzyskać hasło należy ponumerować lewą stronę do prawej np 10 to a 5 to b 7 to t. Po numerowaniu hasło to: B0vGbKt&la!B($vdSpLN
12. Wchodzimy na stronie zadania w okienko logowania i wpisujemy administrator i hasło B0vGbKt&la!B($vdSpLN





ENG:
1. We enter the exercise, run the burp program, enter the categories on the page and see if we have a "welcome back" notification.
2. Let's turn on intercept on in burp and click the home button, intercept the call in burp and send it to the repeater, then turn off the intercept
3. In the repeater we click send and we look in the response if we have a welcome back message it means the trackingId works correctly. In the task TrackingId=RvLfBu6s9EZR1VYNd
4. Then in the repeater after TrackingId=RvLfBu6s9EZR1VYNd we enter ' and 1=1--(ctrl+u) if we get welcome back it means that this case is true. If we entered 1=0 we would get false.
5. Now we will ask the database True or False question based on 1=1, so after the tracking id we enter, ' and( select 'x' from users LIMIT 1)='x'--(ctrl+u) if x=x then we will get welcome back and find out if there is a user table. We got welcome back, it means that the user table exists.
6. Now we will check if the administrator exists in the users table. After trackingId, enter: ' and (select username from users where username='administrator')='administrator'--(ctrl+u) click send and if we get the message welcome back. The adminsitrator exists, We got this message in the task.
7. Now guess the administrator password. First we need to set the length of the password, so we enter: ' and (select users where username ='administrator' and LENGTH(password)>1)='administrator'--(ctrl+u). We get a welcome back, so the password has more than one character.
8. In order not to do it manually all the time, we will use Intruder burp, so we send from repeater to intruder,' and (select users where username ='administrator' and LENGTH(password)>1)='administrator'--  clear everything , select the number 1 from this line and click add. We choose the sniper attack, go to payload, select Numbers and in the options enter from 1 to 50 step 1 and start the attack. at the 20th request the attack changes the length so we know the password is 20 characters long
9. Now we havr to set the password, go back to the repeater and enter ' and (select substring(password,1,1) from users where username'administrator')='a'--(ctrl+u) the first letter of the password is not a, we will not do it manually, so we send it to the intruder. Clean everything, select and add 'a' and choose the sniper attack and in payload choose brute forcer, choose min length 1 and max length 1, we start the attack. we are looking for a character with a different length. The first letter in the problem is 5
10. Instead of doing this 20 times, you can use a different type of attack, clean everything, highlight the first number from (password,1,1) and 'a' , click add and change the sniper to cluster bomb in payload, set 1 to numbers from 1 to 20 step 1. Payload set 2 we set brute forcer min length 1 and max length 1 we start the attack. In the community edition, we have to wait about 2 and a half hours for the attack to end. After the attack, on the left we have numbers and on the right we have letters after filtering.
11. To get the password, number the left side to the right, e.g. 10 is a 5 is b 7 is t. After numbering, the password is: B0vGbKt&la!B($vdSpLN
12. Go to the task page in the login window and enter the administrator and password B0vGbKt&la!B($vdSpLN