This lab contains a blind OS command injection vulnerability in the feedback function.

The application executes a shell command containing the user-supplied details. The output from the command is not returned in the response. However, you can use output redirection to capture the output from the command. There is a writable folder at:

/var/www/images/
The application serves the images for the product catalog from this location. You can redirect the output from the injected command to a file in this folder, and then use the image loading URL to retrieve the contents of the file.

To solve the lab, execute the whoami command and retrieve the output.


1. Włącz strone z zadaniem i uruchom burpa, klikamny na stronie w submit feedback, uzupełniamy dane, włączamy intercepta i wysyłamy feedback poprzez przycisk submit, wyłączany intercepta
2. Przechwycone połączenie wysyłąmy do repetera, po mailu możemy sprawdzić czy strona jest wrażliwa na atak poprzez wpisanie & sleep 10 # ctrl+u, jeżeli dostaniemy odpowiedź po 10 sekundach to znaczy, że jest wrażliwa strona.
3. Klikamy na przycisk home i w http history w opcji filtrowania zaznaczamy by wczytywał nam burp również obrazy.Wybieramy dowolny obrazek np z filename=23.jpg z http history i wysyłany go do repetera, klikamy send i otrzymujemy kontent zdjęcia
4. Wracamy do pierwszego repetera i zamiast próbować dostać odpowiedź po 10 sekundach, wpisujemy & whoami > /var/www/images/output.txt # (ctrl+u)  (output nasza nazwa) i klikamy send, teraz należy się upewnić czy plik output został stworzony
5. Wracamy do drugiego repetera i podmieniamy filename=23.jpg na filename=output.txt i klikamy send, otrzymujemy w odpowiedzi login peter i hasło T8sM70


ENG:

1.Use Burp Suite to intercept and modify the request that submits feedback.
2.Modify the email parameter, changing it to:

email=||whoami>/var/www/images/output.txt||
3.Now use Burp Suite to intercept and modify the request that loads an image of a product.
4.Modify the filename parameter, changing the value to the name of the file you specified for the output of the injected command:

filename=output.txt
5.Observe that the response contains the output from the injected command.


